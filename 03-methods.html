<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="keywords" content="Travel modeling, Uncertainty">

<title>Evaluating the Impacts of Parameter Uncertainty in Transportation Demand Models - 3&nbsp; Model Design and Methodology</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-results.html" rel="next">
<link href="./02-literature.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-methods.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model Design and Methodology</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Evaluating the Impacts of Parameter Uncertainty in Transportation Demand Models</a> 
        <div class="sidebar-tools-main">
    <a href="./Evaluating-the-Impacts-of-Parameter-Uncertainty-in-Transportation-Demand-Models.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-literature.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literature Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-methods.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model Design and Methodology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-results.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sensitivity Analysis Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-conclusions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Conclusions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#model-design" id="toc-model-design" class="nav-link active" data-scroll-target="#model-design"><span class="header-section-number">3.1</span> Model Design</a></li>
  <li><a href="#uncertainty-design" id="toc-uncertainty-design" class="nav-link" data-scroll-target="#uncertainty-design"><span class="header-section-number">3.2</span> Uncertainty Design</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-methods" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Model Design and Methodology</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="model-design" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="model-design"><span class="header-section-number">3.1</span> Model Design</h2>
<p>To examine the effects of parameter input sensitivity, we adapted a trip-based travel demand model from the Roanoke Valley Transportation Planning Organization <a href="https://github.com/xinwangvdot/rvtpo">(RVTPO)</a>. The RVTPO model provides an ideal testing environment for this research because it uses an integrated mode and destination choice framework common in more advanced trip-based models. At the same time, its small size (approximately 215 zones) means the entire model runs in a few minutes and thus allows for efficient testing of multiple model runs.</p>
<p>The total passenger trips <span class="math inline">\(T\)</span> traveling from zone <span class="math inline">\(i\)</span> to zone <span class="math inline">\(j\)</span> on the highway in a period <span class="math inline">\(t\)</span> is <span id="eq-trips"><span class="math display">\[
T_{ijt} = P_i * \mathcal{P}_{\mathrm{auto}}(\beta, C_{ijt}) * \mathcal{P}_j(\gamma, A_j, MCLS_{ijt}) * \Delta_t
\tag{3.1}\]</span></span> where <span class="math inline">\(P\)</span> is the productions at zone <span class="math inline">\(i\)</span>; <span class="math inline">\(\mathcal{P}_{\mathrm{car}}\)</span> is the car mode choice probability determined by utility parameters <span class="math inline">\(\beta\)</span> and the travel costs <span class="math inline">\(C\)</span> between <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> at time period <span class="math inline">\(t\)</span>; <span class="math inline">\(\mathcal{P}_{j}\)</span> is the destination choice probability of choosing destination <span class="math inline">\(j\)</span> given the utility parameters <span class="math inline">\(\gamma\)</span>, attractions <span class="math inline">\(A\)</span>, and the impedance as the mode choice model logsum <span class="math inline">\(MCLS_{ijt}\)</span>. A time-of-day and direction factor <span class="math inline">\(\Delta\)</span> finalizes the total assigned trips.</p>
<p>The productions <span class="math inline">\(P_i\)</span>, and attractions <span class="math inline">\(A_j\)</span> were extracted from the RVTPO Model and held constant. The attractions are determined from the socioeconomic (SE) data. The SE data included information by TAZ for the total population, number of households, total workers, and workers by employment type. The trip productions are organized by TAZ and trip purpose. The trip purposes used in this model are Home Based Work (HBW), Home Based Other (HBO), Non-Home Based (NHB), Commercial Vehicles (CV), Internal-External (IXXI), and External-External (XX). Only the first three are analysed, but all of the purposes are assigned to the network. CV, IXXI, and XX trips were kept fixed for this analysis.</p>
<p>The two parameter vectors <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma\)</span> describe the mode choice model and destination choice model coefficients, respectively. Mode choice estimates how many trips from <span class="math inline">\(i\)</span> to <span class="math inline">\(j\)</span> will happen on each available mode <span class="math inline">\(k\)</span>.This model analyses three modes of transportation: auto, non-motorized, and transit. The mode by which a trip is made is determined by calculated utilities for the three modes. These utilities take inputs from parameter values and time and distance skims <span class="math inline">\(X\)</span>. Skims are either the time or distance to travel between zone pairs. Travel time for auto used the single occupancy vehicle peak time, non-motorized travel time used the distance skim multiplied by a factor of average walking speed (3 mph), and transit time used the walk to bus peak time. The mode choice parameters (constants and coefficients) were also obtained from the RVTPO model. These values are shown in <a href="#tbl-choicecoeff">Table&nbsp;<span>3.1</span></a>.</p>
<div class="cell" data-hash="03-methods_cache/html/tbl-choicecoeff_3cba568353e99840ba6617effc5e27af">
<div class="cell-output-display">
<div id="tbl-choicecoeff" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;3.1: Choice model parameters</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">HBW</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">HBO</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">NHB</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="4">
<td colspan="5" style="border-bottom: 1px solid"><strong>Mode Choice Coefficients</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">In-vehicle travel time</td>
<td style="text-align: left;">$\beta_{ivtt}$</td>
<td style="text-align: right;">-0.0250</td>
<td style="text-align: right;">-0.0150</td>
<td style="text-align: right;">-0.0200</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Travel cost</td>
<td style="text-align: left;">$\beta_{tc}$</td>
<td style="text-align: right;">-0.0016</td>
<td style="text-align: right;">-0.0024</td>
<td style="text-align: right;">-0.0025</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Walk distance</td>
<td style="text-align: left;">$\beta_{wd}$</td>
<td style="text-align: right;">-0.0625</td>
<td style="text-align: right;">-0.0375</td>
<td style="text-align: right;">-0.0500</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Auto operating cost (cents/mile)</td>
<td style="text-align: left;">$\beta_{ac}$</td>
<td style="text-align: right;">13.6000</td>
<td style="text-align: right;">13.6000</td>
<td style="text-align: right;">13.6000</td>
</tr>
<tr class="even" data-grouplength="2">
<td colspan="5" style="border-bottom: 1px solid"><strong>Mode Choice Constants</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Transit constant</td>
<td style="text-align: left;">$k_{trn}$</td>
<td style="text-align: right;">-0.3903</td>
<td style="text-align: right;">-1.9811</td>
<td style="text-align: right;">-2.2714</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">NonMotorized constant</td>
<td style="text-align: left;">$k_{nmot}$</td>
<td style="text-align: right;">-1.2258</td>
<td style="text-align: right;">-0.3834</td>
<td style="text-align: right;">-0.8655</td>
</tr>
<tr class="odd" data-grouplength="5">
<td colspan="5" style="border-bottom: 1px solid"><strong>Destination Choice Parameters</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Households</td>
<td style="text-align: left;">$\gamma_{hh}$</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">1.1657</td>
<td style="text-align: right;">0.5664</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Other + Office</td>
<td style="text-align: left;">$\gamma_{oth + off}$</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.8064</td>
<td style="text-align: right;">0.5626</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Office</td>
<td style="text-align: left;">$\gamma_{off}$</td>
<td style="text-align: right;">0.4586</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Other</td>
<td style="text-align: left;">$\gamma_{oth}$</td>
<td style="text-align: right;">1.6827</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Retail</td>
<td style="text-align: left;">$\gamma_{ret}$</td>
<td style="text-align: right;">0.6087</td>
<td style="text-align: right;">2.2551</td>
<td style="text-align: right;">5.1190</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The utility equations for the mode choice model are as follows: <span class="math display">\[
\begin{aligned}
U_{auto} &amp;= \beta_{ivtt} * X_{auto} + \beta_{tc} * \beta_{ac} * X_{dist}\\
U_{nmot} &amp;= k_{nmot} + 20 * \beta_{wd}*X_{nmot}\\
U_{trn} &amp;= k_{trn} + \beta_{ivtt} * X_{trn}
\end{aligned}
\]</span> These utilities are used to calculate the MCLS by: <span id="eq-mcls"><span class="math display">\[
MCLS_{ij} = \ln\left(\sum_{k \in K} e^{U_{ijk}}\right).
\tag{3.2}\]</span></span> If the distance was greater than 2 miles, non-motorized travel was excluded.</p>
<p>This logsum value is then used as the primary impedance for a destination choice model <span class="citation" data-cites="ben-akiva1985">(<a href="06-references.html#ref-ben-akiva1985" role="doc-biblioref">Ben-Akiva &amp; Lerman, 1985</a>)</span>. Destination choice estimates travel patterns based on mode choice, trip generators (workers and households), and destination choice parameters. These parameter values are also shown in <a href="#tbl-choicecoeff">Table&nbsp;<span>3.1</span></a>. The destination choice utility is the primary impedance (mode choice logsum value) plus the natural log of the size term, where the sized term is calculated as: <span id="eq-dcsizeterm"><span class="math display">\[
A_j = \gamma_{hh} * \mathrm{HH} + \gamma_{off} * \mathrm{OFF} + \gamma_{ret} * \mathrm{RET} + \gamma_{oth} * \mathrm{OTH} + \\ \gamma_{oth+off} * \mathrm{OFFOTH}
\tag{3.3}\]</span></span> HH is the total households in zone <span class="math inline">\(j\)</span>. OFF, RET, and OTH are the jobs in zone <span class="math inline">\(j\)</span> by employment type office, retail, and other respectively. The destination choice utility is then transformed into a destination choice logsum value with: <span id="eq-dcls"><span class="math display">\[
DCLS = \ln \left(\sum_{j \in J} e^{\ln(A_j) + 1* MCLS_{ij}}\right)
\tag{3.4}\]</span></span></p>
<p>The probability of both the mode choice and destination choice are calculated using the exponentiated utility divided by the corresponding logsum. These probabilities in conjunction with the trip productions can calculate the number of production-attraction (PA) trips between each zone by each mode and purpose. The auto trips are calculated by multiplying the probability of the destination by PA pair, the productions for each origin, and the probability of an auto mode choice by PA pair. This results in PA auto trips. The same process is followed for the other two modes. These PA trips are converted into origin destination (OD) trips by multiplying the trips by corresponding time of day factors (see #eq-trips). These trips are calculated using Bentley’s CUBE and the RVTPO model. The trips, by time period, are assigned to the highway network by the shortest path by time using free flow speed and with link capacity as a restriction.</p>
</section>
<section id="uncertainty-design" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="uncertainty-design"><span class="header-section-number">3.2</span> Uncertainty Design</h2>
<p>Within the mode and destination models there exists uncertainty within the parameters in <a href="#tbl-choicecoeff">Table&nbsp;<span>3.1</span></a>. Sampling methods can take the defined uncertainty and choose potential parameter values within the possible range. Two common methods for parameter sampling include, Monte Carlo (MC) simulation and Latin hypercube sampling (LHS). MC simulation draws independently from multiple distributions, while LHS makes draws that cover the parameter space more efficiently and can capture the joint distribution between two or more parameter values <span class="citation" data-cites="helton2003a">(<a href="06-references.html#ref-helton2003a" role="doc-biblioref">Helton &amp; Davis, 2003</a>)</span>. As a result, LHS can reduce the number of draws needed to fully re-create the statistical variance in a model, but the amount of reduction is unknown and may not be universal to all problems <span class="citation" data-cites="yang2013">(<a href="06-references.html#ref-yang2013" role="doc-biblioref">Yang et al., 2013</a>)</span>.</p>
<p>With the trip-based model described above, MC and LHS methods were used to develop alternative parameter sets to evaluate uncertainty. To identify a standard deviation for each parameter, a coefficient of variation was used. A set coefficient of variation of 0.10 was used for the four mode choice coefficients and the destination choice parameters. The mode choice constants were kept the same across all iterations. Literature had identified a coefficient of variation of 0.30, but for this analysis that caused an unrealistic value of time, and thus it was changed to be 0.10 <span class="citation" data-cites="zhao2002">(<a href="06-references.html#ref-zhao2002" role="doc-biblioref">Zhao &amp; Kockelman, 2002</a>)</span>. Value of time is a ratio in units of money per time that should be compared to the regional wage rate. Using a <span class="math inline">\(c_v\)</span> of 0.30 the value of time range was from <span class="math inline">\(\$2\)</span> to <span class="math inline">\(\$32\)</span> /hr, whereas using a <span class="math inline">\(c_v\)</span> of 0.10 the range was <span class="math inline">\(\$6\)</span> to <span class="math inline">\(\$14\)</span> /hr. The latter seemed more rational because it is related to wage rates and thus a <span class="math inline">\(c_v\)</span> of 0.10 was used for our analysis. The standard deviation was equal to 0.10 multiplied by the mean, where the mean values in this situation are the base scenario parameters (as identified in <a href="#tbl-choicecoeff">Table&nbsp;<span>3.1</span></a> ).</p>
<p>The MC random sampling uses the R function of <code>rnorm</code>. LHS uses the <code>lhs</code> package in R. Since this package only chooses variables on a zero to one scale, the values given use a function to put the random sampling on the right scale needed for the given parameter. The full code for both methods can be found in a public <a href="https://github.com/natmaegray/sensitivity_thesis">GitHub repository</a>. One hundred and 600 draws of random samples for both methods are generated. With these generated parameters, the mode choice model step was run for every set of input parameters for each purpose. The average MCLS value for each run was determined to compare each continuous draw. This allowed us to see how many iterations of which sampling type would be sufficient to show a full range of possible outcomes.</p>
<p>The parameters generated were compared for both sampling methods. <a href="#fig-parameter">Figure&nbsp;<span>3.1</span></a> shows the distributions for the HBW parameters when using 100 and 600 draws. These distributions show that LHS gives normally distributed parameters with fewer draws than MC sampling: at 100 draws LHS shows a nearly perfect normal distribution, where there are some discrepancies for the MC generated parameters. These Figures show that LHS is likely to estimate the full variance of the results with fewer draws.</p>
<div id="fig-parameter" class="cell quarto-layout-panel" data-hash="03-methods_cache/html/fig-parameter_ddfde210b845ee7df80718e1bd426c56">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-parameter-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-methods_files/figure-html/fig-parameter-1.png" class="img-fluid figure-img" data-ref-parent="fig-parameter" width="672"></p>
<figcaption class="figure-caption">(a) 100 draws</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-parameter-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-methods_files/figure-html/fig-parameter-2.png" class="img-fluid figure-img" data-ref-parent="fig-parameter" width="672"></p>
<figcaption class="figure-caption">(b) 600 draws</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.1: Sampled mode and destination choice parameters for HBW trip purpose.</figcaption><p></p>
</figure>
</div>
<p>To determine if LHS is effective at a reasonable amount of iterations, the cumulative mean and the cumulative standard deviation of the average MCLS value for every zone (see <a href="#eq-mcls">Equation&nbsp;<span>3.2</span></a> ) was calculated for each additional draw for both sampling methods. MCLS is an impedance term which is an important value for destination choice and region routing. The average MCLS, <span class="math inline">\(x\)</span>, was used as a measure of outcome possibilities to simplify a complex term as a single value to compare by across all iterations. The cumulative mean is calculated as: <span id="eq-cmclsmean"><span class="math display">\[
\mu_i = \frac{x_1 + ... + x_i}{n}
\tag{3.5}\]</span></span> and the cumulative standard deviation is calculated as: <span id="eq-sdi"><span class="math display">\[
SD_i = \sqrt{\frac{\sum (x_i - \mu_i)^2 }{n-1}}.
\tag{3.6}\]</span></span> The cumulative mean shows how the average MCLS stabilizes across each iteration, and the cumulative standard deviation is used to show the 95% confidence interval of that mean. When the cumulative mean for the draws stabilizes, that shows that the amount of generated parameters has captured the possible variance of the results. This is shown for two of the three trip purposes in <a href="#fig-cm">Figure&nbsp;<span>3.2</span></a>.</p>
<div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## HBW</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(hbw_stats_100)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(hbw_stats_600)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>hbw_stats <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(hbw_stats_100, hbw_stats_600, <span class="at">.id =</span> <span class="st">"ndraws"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ndraws =</span> <span class="fu">case_when</span>(ndraws <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"100 Draws"</span>,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                          ndraws <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"600 Draws"</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>hbw_cm <span class="ot">&lt;-</span> hbw_stats <span class="sc">%&gt;%</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">!=</span> <span class="st">"base"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> draw, <span class="at">y =</span> cummean, <span class="at">ymin =</span> cummean <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>cumvar, <span class="at">ymax =</span> cummean <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>cumvar, <span class="at">colour =</span> type, <span class="at">fill =</span> type, <span class="at">group =</span> type) <span class="sc">+</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="co">#    ylim(0.025, 0.15) +</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Draw"</span>, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Cumulative Mean of Average MCLS"</span>,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"method"</span>) <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_hue</span>(<span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(ndraws), <span class="at">scales =</span> <span class="st">"free_x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.
ℹ Please use `linewidth` instead.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## HBO</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(hbo_stats_100)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(hbo_stats_600)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>hbo_stats <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(hbo_stats_100, hbo_stats_600, <span class="at">.id =</span> <span class="st">"ndraws"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ndraws =</span> <span class="fu">case_when</span>(ndraws <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"100 Draws"</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                          ndraws <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"600 Draws"</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>hbo_cm <span class="ot">&lt;-</span> hbo_stats <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">!=</span> <span class="st">"base"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> draw, <span class="at">y =</span> cummean, <span class="at">ymin =</span> cummean <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>cumvar, <span class="at">ymax =</span> cummean <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>cumvar, <span class="at">colour =</span> type, <span class="at">fill =</span> type, <span class="at">group =</span> type) <span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#    ylim(0.025, 0.15) +</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Draw"</span>, </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Cumulative Mean of Average MCLS"</span>,</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"method"</span>) <span class="sc">+</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_hue</span>(<span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(ndraws), <span class="at">scales =</span> <span class="st">"free_x"</span>)</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a><span class="do">## NHB</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(nhb_stats_100)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(nhb_stats_600)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>nhb_stats <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(nhb_stats_100, nhb_stats_600, <span class="at">.id =</span> <span class="st">"ndraws"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">ndraws =</span> <span class="fu">case_when</span>(ndraws <span class="sc">==</span> <span class="st">"1"</span> <span class="sc">~</span> <span class="st">"100 Draws"</span>,</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>                          ndraws <span class="sc">==</span> <span class="st">"2"</span> <span class="sc">~</span> <span class="st">"600 Draws"</span>))</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>nhb_cm <span class="ot">&lt;-</span> nhb_stats <span class="sc">%&gt;%</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">!=</span> <span class="st">"base"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(<span class="at">x =</span> draw, <span class="at">y =</span> cummean, <span class="at">ymin =</span> cummean <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>cumvar, <span class="at">ymax =</span> cummean <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>cumvar, <span class="at">colour =</span> type, <span class="at">fill =</span> type, <span class="at">group =</span> type) <span class="sc">+</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_ribbon</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">colour =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co">#    ylim(0.025, 0.15) +</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Draw"</span>, </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Cumulative Mean of Average MCLS"</span>,</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>         <span class="at">color =</span> <span class="st">"method"</span>) <span class="sc">+</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_hue</span>(<span class="at">direction =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(ndraws), <span class="at">scales =</span> <span class="st">"free_x"</span>)</span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a><span class="do">## Plot</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>hbw_cm</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>hbo_cm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-cm" class="cell quarto-layout-panel" data-hash="03-methods_cache/html/fig-cm_ce27f06ac0959a239d3ab3066301725a">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-cm-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-methods_files/figure-html/fig-cm-1.png" class="img-fluid figure-img" data-ref-parent="fig-cm" width="672"></p>
<figcaption class="figure-caption">(a) HBW</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 100.0%;justify-content: center;">
<div id="fig-cm-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03-methods_files/figure-html/fig-cm-2.png" class="img-fluid figure-img" data-ref-parent="fig-cm" width="672"></p>
<figcaption class="figure-caption">(b) HBO</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;3.2: Average mode choice logsum (impedance) cumulative mean and 95% confidence interval with 100 and 600 draws.</figcaption><p></p>
</figure>
</div>
</div>
<p>For all three trip purposes, both sampling methods had a stabilized mean by 100 draws. The LHS methods standard deviation ribbon was generally thinner than the MC method. From the narrowed cumulative standard deviation, and that the parameter values are better normally distributed when using LHS, that method of sampling was used for the assignment analysis of the model. Since LHS captures the possible variance at a small enough number of iterations, it can be used for large transportation demand models. From these results it was decided to use 100 LHS samples parameters to evaluate uncertainty within each step of the model. The next chapter includes the results of applying these sampled parameters to the travel demand model.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-ben-akiva1985" class="csl-entry" role="listitem">
Ben-Akiva, M., &amp; Lerman, S. R. (1985). <em>Discrete <span>Choice Analysis</span>: <span>Theory</span> and <span>Applications</span> to <span>Travel Demand</span></em>. <span>MIT Press</span>. <a href="https://www.jstor.org/stable/1391567">https://www.jstor.org/stable/1391567</a>
</div>
<div id="ref-helton2003a" class="csl-entry" role="listitem">
Helton, J. C., &amp; Davis, F. J. (2003). Latin hypercube sampling and the propagation of uncertainty in analyses of complex systems. <em>Reliability Engineering &amp; System Safety</em>, <em>81</em>(1), 23–69. <a href="https://doi.org/10.1016/S0951-8320(03)00058-9">https://doi.org/10.1016/S0951-8320(03)00058-9</a>
</div>
<div id="ref-yang2013" class="csl-entry" role="listitem">
Yang, C., Chen, A., Xu, X., &amp; Wong, S. C. (2013). Sensitivity-based uncertainty analysis of a combined travel demand model. <em>Transportation Research Part B: Methodological</em>, <em>57</em>, 225–244. <a href="https://doi.org/10.1016/j.trb.2013.07.006">https://doi.org/10.1016/j.trb.2013.07.006</a>
</div>
<div id="ref-zhao2002" class="csl-entry" role="listitem">
Zhao, Y., &amp; Kockelman, K. M. (2002). The propagation of uncertainty through travel demand models: <span>An</span> exploratory analysis. <em>The Annals of Regional Science</em>, <em>36</em>(1), 145–163. <a href="https://doi.org/10.1007/s001680200072">https://doi.org/10.1007/s001680200072</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-literature.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literature Review</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-results.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Sensitivity Analysis Results</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>